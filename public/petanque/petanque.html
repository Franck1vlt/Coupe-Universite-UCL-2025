<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petanque</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Dans styles.css, pensez à définir par exemple : 
         .phase-content { display: flex; } 
         .hidden { display: none !important; }
    -->
    <style>
      .correction-button {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #f44336;
        color: white;
        border: none;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        z-index: 1000;
        transition: all 0.3s ease;
      }
  
      .correction-button:hover {
        transform: scale(1.1);
        background-color: #d32f2f;
      }
  
      .match.terminé {
        cursor: pointer;
      }
  
      .match.terminé:hover {
        border: 2px solid #f44336;
      }
    </style>
</head>
<body>
    <button id="correctionMode" class="correction-button" onclick="toggleCorrectionMode()">✏️</button>
    <div class="background-lines"></div>
    <div class="container">
      <header>
        <div class="phase-selector">
          <select id="phaseSelect" class="phase-select">
            <option value="final-phase">Phase finale</option>
            <option value="ranking-phase">Classement final</option>
          </select>
        </div>
        <h1>Pétanque</h1>
        <div class="subtitle">Phase à élimination directe</div>
      </header>
        
      <div class="tournament-container">
        <!-- SECTION PHASE FINALE -->
        <div class="bracket phase-content" id="final-phase">
            <!-- Barrages -->
            <div class="round">
                <div class="round-title">Barrages</div>
                <!-- Match 1 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="1" data-match-type="barrage">
                        <div class="team">
                            <div class="team-name">ESSLIL</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">USCHOOL</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector right"></div>
                </div>
                <!-- Match 2 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="2" data-match-type="barrage">
                        <div class="team">
                            <div class="team-name">LIDD</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">FLD</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector right"></div>
                </div>
                <!-- Match 3 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="3" data-match-type="barrage">
                        <div class="team">
                            <div class="team-name">ESPAS-ESTICE</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">ESPOL</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector right"></div>
                </div>
                <!-- Match 4 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="4" data-match-type="barrage">
                        <div class="team">
                            <div class="team-name">PIKTURA</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">FLSH</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector right"></div>
                </div>
            </div>

            <!-- Quarts de finale -->
            <div class="round">
                <div class="round-title">Quarts de finale</div>
                <!-- QF1 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="5" data-match-type="quarterfinal">
                        <div class="team">
                            <div class="team-name">FMMS</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">À déterminer</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector top"></div>
                </div>
                <!-- QF2 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="6" data-match-type="quarterfinal">
                        <div class="team">
                            <div class="team-name">FGES</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">À déterminer</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector bottom"></div>
                </div>
                <!-- QF3 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="7" data-match-type="quarterfinal">
                        <div class="team">
                            <div class="team-name">IKPO</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">À déterminer</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector top"></div>
                </div>
                <!-- QF4 -->
                <div class="match-wrapper">
                    <div class="match" data-match-id="8" data-match-type="quarterfinal">
                        <div class="team">
                            <div class="team-name">ICAM</div>
                            <div class="score">-</div>
                        </div>
                        <div class="team">
                            <div class="team-name">À déterminer</div>
                            <div class="score">-</div>
                        </div>
                    </div>
                    <div class="connector bottom"></div>
                </div>
            </div>

            <!-- Demi-finales -->
            <div class="round2">
            <div class="round-title">Demi-finales</div>
            <div class="match-wrapper">
                <div class="match" data-match-id="9" data-match-type="semifinal" data-position="1">
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                </div>
                <div class="connector top"></div>
            </div>
            <div class="match-wrapper">
                <div class="match" data-match-id="10" data-match-type="semifinal" data-position="2">
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                </div>
                <div class="connector bottom"></div>
            </div>
            </div>
            <!-- Finale & Petite Finale -->
            <div class="round3">
            <div class="round-title">Finale</div>
            <div class="match-wrapper">
                <div class="match" data-match-id="11" data-match-type="final-h" data-position="1">
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                </div>
            </div>
            <div class="small-final">
                <div class="small-final-title">Match pour la 3ème place</div>
                <div class="match" data-match-id="10" data-match-type="smallfinal" data-position="1">
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                <div class="team">
                    <div class="team-name">À déterminer</div>
                    <div class="score">0</div>
                </div>
                </div>
            </div>
            </div>
            <!-- Champion -->
            <div class="round4">
            <div class="round-title">Champion</div>
            <div class="trophy">
                <div class="trophy-icon">🏆</div>
                <div class="champion" id="champion">À déterminer</div>
            </div>
            </div>
        </div>
                
        <!-- SECTION CLASSEMENT FINAL -->
        <div class="bracket phase-content" id="ranking-phase">
            <div class="ranking-container">
            <div class="round-title">Classement Final Basket</div>
            <div class="ranking-table">
                <div class="ranking-row header">
                <div class="rank">Position</div>
                <div class="team-name">Équipe</div>
                <div class="points">Points</div>
                </div>
                <div id="rankingList">
                <!-- Rempli dynamiquement par JavaScript -->
                </div>
            </div>
            </div>
        </div>
    </div>
    <div style="text-align: center;">
        <button class="reset-button" id="resetTournament" onclick="resetTournament()">Réinitialiser le tournoi</button>
        <button onclick="simulateTournament()">Simuler la compétition</button>
        <button class="back-button" onclick="window.location.href='../index.html'">Retour</button>
    </div>
    
    <!-- Changer le lien vers tournament.js pour utiliser le bon chemin -->
    <script src="tournament.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const phaseSelect = document.getElementById('phaseSelect');
      const phaseContents = document.querySelectorAll('.phase-content');
      
      phaseSelect.addEventListener('change', async function() {
        const selectedPhase = phaseSelect.value;
        phaseContents.forEach(function(content) {
          if (content.id === selectedPhase) {
            content.classList.remove('hidden');
          } else {
            content.classList.add('hidden');
          }
        });
        
        if (selectedPhase === 'ranking-phase') {
          try {
            await updateRankingDisplay();
          } catch (error) {
            console.error('Erreur lors de la mise à jour du classement:', error);
          }
        }
      });
      
      // Déclencher l'événement change initial de manière asynchrone
      setTimeout(() => phaseSelect.dispatchEvent(new Event('change')), 0);
    });  
    </script>
</body>
</html>